CREATE TABLE dlithe.dbo.SHK_DEPARTMENT(
DEPT_ID INT PRIMARY KEY,
DEPT_NAME VARCHAR(20) NOT NULL,
DEPT_LOCATION VARCHAR(50)
);

CREATE TABLE dlithe.dbo.SHK_EMPLOYEE(
EMP_ID INT PRIMARY KEY,
EMP_NAME VARCHAR(20),
EMP_AGE INT,
EMP_ADDRESS VARCHAR(50),
DEPT_NO INT FOREIGN KEY(DEPT_NO) REFERENCES SHK_DEPARTMENT(DEPT_ID)
);

CREATE TABLE dlithe.dbo.SHK_LOCATION(
LOC_CITY VARCHAR(20) NOT NULL,
LOC_PINCODE INT PRIMARY KEY,
LOC_STATE VARCHAR(20) UNIQUE
);

INSERT INTO SHK_DEPARTMENT VALUES(1,'JAVA','BANGALORE');
INSERT INTO SHK_DEPARTMENT VALUES(2,'DOTNET','BANGALORE');
INSERT INTO SHK_DEPARTMENT VALUES(3,'DATABASE','BANGALORE');
INSERT INTO SHK_DEPARTMENT VALUES(4,'TESTING','BANGALORE');

SELECT * FROM SHK_DEPARTMENT 

INSERT INTO SHK_EMPLOYEE VALUES(1,'SACHIN',22,'BANGALORE',1);
INSERT INTO SHK_EMPLOYEE VALUES(2,'ABHISHEK',22,'BANGALORE',1);
INSERT INTO SHK_EMPLOYEE VALUES(3,'ARUN',22,'BANGALORE',2);
INSERT INTO SHK_EMPLOYEE VALUES(4,'ARJUN',22,'BANGALORE',2);
INSERT INTO SHK_EMPLOYEE VALUES(5,'SHON',22,'BANGALORE',3);

SELECT * FROM SHK_EMPLOYEE 

INSERT INTO SHK_LOCATION VALUES('BANGALORE',11,'KARNATAKA');
INSERT INTO SHK_LOCATION VALUES('KOCHI',22,'KERALA');
INSERT INTO SHK_LOCATION VALUES('CHENNAI',32,'TAMILNADU');
--ALTER TABLE SHK_EMPLOYEE ADD CHECK(EMP_AGE);

SELECT * FROM SHK_LOCATION
SELECT * FROM SHK_DEPARTMENT
SELECT * FROM SHK_EMPLOYEE

SELECT * FROM DLITHE.DBO.S_HREMPLOYEES

SELECT FIRST_NAME FROM S_HREMPLOYEES 

SELECT * FROM S_HREMPLOYEES sh WHERE DEPARTMENT_ID=50;

SELECT * FROM S_HREMPLOYEES sh WHERE EMPLOYEE_ID>=170;

SELECT *FROM S_HREMPLOYEES sh WHERE EMPLOYEE_ID <=120;

SELECT *FROM S_HREMPLOYEES sh WHERE JOB_ID!='IT_PROG';

SELECT * FROM S_HREMPLOYEES sh WHERE MANAGER_ID <>114;

SELECT * FROM S_HREMPLOYEES sh WHERE MANAGER_ID =100 OR MANAGER_ID =102;

SELECT * FROM S_HREMPLOYEES sh WHERE MANAGER_ID = 100 AND DEPARTMENT_ID =50;

SELECT * FROM S_HREMPLOYEES sh WHERE EMPLOYEE_ID BETWEEN 100 AND 105;

SELECT * FROM S_HREMPLOYEES sh WHERE FIRST_NAME  LIKE '%K';

SELECT * FROM S_HREMPLOYEES sh WHERE LAST_NAME NOT LIKE '%C%';

SELECT * FROM S_HREMPLOYEES sh WHERE COMMISSION_PCT IS NULL;

SELECT * FROM S_HREMPLOYEES sh WHERE COMMISSION_PCT IS NOT NULL;

SELECT * FROM S_HREMPLOYEES sh WHERE DEPARTMENT_ID IN (50,60);

SELECT TOP 10 * FROM S_HREMPLOYEES sh ;

SELECT UPPER(FIRST_NAME) FROM S_HREMPLOYEES sh ;

SELECT LOWER(LAST_NAME) FROM S_HREMPLOYEES sh ;

SELECT INITCAP(EMAIL) FROM S_HREMPLOYEES sh ;

SELECT TRIM(FIRST_NAME) FROM S_HREMPLOYEES sh ;

SELECT LTRIM(JOB_ID) FROM S_HREMPLOYEES sh ;

SELECT TRIM(FIRST_NAME) FROM S_HREMPLOYEES sh ;

SELECT LEN(EMAIL) AS LEN FROM S_HREMPLOYEES sh ;

SELECT REPLACE(JOB_ID,'_','@') FROM S_HREMPLOYEES sh ;

SELECT CONCAT(FIRST_NAME,' ',LAST_NAME) AS FULL_NAME FROM S_HREMPLOYEES sh ;

SELECT CHARINDEX('A',FIRST_NAME),EMPLOYEE_ID  AS POSITIONS FROM S_HREMPLOYEES sh ;

SELECT SUBSTRING(EMAIL,2,6), EMPLOYEE_ID FROM S_HREMPLOYEES sh ;

SELECT CASE WHEN DEPARTMENT_ID=50 THEN 'DATABASE'
WHEN DEPARTMENT_ID = 90 THEN 'TESTING'
ELSE FIRST_NAME
END
FROM S_HREMPLOYEES sh ;

SELECT SUM(SALARY) FROM S_HREMPLOYEES sh ;

SELECT MIN(SALARY), MAX(SALARY), AVG(SALARY) FROM S_HREMPLOYEES sh ;

SELECT COUNT(*),JOB_ID  FROM S_HREMPLOYEES sh 
GROUP BY JOB_ID ;

--SELECT COUNT(1),JOB_ID, DEPARTMENT_ID

SELECT SUM(SALARY),JOB_ID
FROM DBO.S_HREMPLOYEES sh
WHERE JOB_ID IS NOT NULL
GROUP BY JOB_ID 
HAVING SUM(SALARY)>20000
ORDER BY JOB_ID  DESC;

SELECT * FROM (
SELECT DENSE_RANK() OVER (PARTITION BY  DEPARTMENT_ID ORDER BY SALARY ASC) AS DRNK,SALARY,DEPARTMENT_ID
FROM S_HREMPLOYEES sh
WHERE DEPARTMENT_ID = 90
)X
WHERE DRNK=1

SELECT * FROM (
SELECT DENSE_RANK () OVER (PARTITION BY DEPARTMENT_ID ORDER BY SALARY DESC) AS DRNK,SALARY,DEPARTMENT_ID,HIRE_DATE
FROM DBO.S_HREMPLOYEES sh 
WHERE DEPARTMENT_ID=90
)X
WHERE DRNK=1

SELECT * FROM (
SELECT DENSE_RANK () OVER (PARTITION BY DEPARTMENT_ID ORDER BY HIRE_DATE  ASC) AS DRNK,SALARY,DEPARTMENT_ID,HIRE_DATE
FROM DBO.S_HREMPLOYEES sh 
WHERE DEPARTMENT_ID=90
)X
WHERE DRNK=1;

SELECT * FROM (
SELECT DENSE_RANK () OVER (PARTITION BY DEPARTMENT_ID ORDER BY HIRE_DATE  ASC) AS DRNK,SALARY,DEPARTMENT_ID,HIRE_DATE
FROM DBO.S_HREMPLOYEES sh 
WHERE DEPARTMENT_ID=90
)X
WHERE DRNK=1

SELECT * FROM S_HREMPLOYEES sh ;
SELECT * FROM S_HRDEPARTMENTS sh ;
SELECT * FROM S_HRCOUNTRIES sh ;
SELECT * FROM S_HRLOCATIONS sh ;
SELECT * FROM S_HREMP_DETAILS_VIEW shdv ;
SELECT * FROM S_HRJOB_HISTORY shh ;
SELECT * FROM S_HRJOBS sh ;
SELECT * FROM S_HRREGIONS sh ;

SELECT * FROM (
SELECT DENSE_RANK () OVER (PARTITION BY DEPARTMENT_ID ORDER BY HIRE_DATE  ASC) AS DRNK,SALARY,DEPARTMENT_ID,HIRE_DATE
FROM DBO.S_HREMPLOYEES sh 
--WHERE DEPARTMENT_ID=90
)X
WHERE DRNK=3

SELECT
*
FROM
	DBO.S_HREMPLOYEES sh
INNER JOIN DBO.S_HRDEPARTMENTS sh2
ON SH.DEPARTMENT_ID=SH2.DEPARTMENT_ID
RIGHT JOIN DBO.S_HRLOCATIONS SH3
ON SH2.LOCATION_ID=SH3.LOCATION_ID
INNER JOIN DBO.S_HRCOUNTRIES SH4
ON SH3.COUNTRY_ID = SH4.COUNTRY_ID 
LEFT JOIN DBO.S_HRREGIONS SH5
ON SH4.REGION_ID =SH5.REGION_ID 
FULL OUTER JOIN DBO.S_HRJOBS SH6
ON SH.JOB_ID=SH6.JOB_ID ;

SELECT * FROM S_HREMPLOYEES sh WHERE DEPARTMENT_ID IN(
SELECT DEPARTMENT_ID  FROM S_HRDEPARTMENTS sh2 
--WHERE SH.DEPARTMENT_ID = SH2.DEPARTMENT_ID
);

SELECT * FROM S_HREMPLOYEES sh ;
WHERE  EXISTS(SELECT DEPARTMENT_ID  FROM S_HRDEPARTMENTS sh2  WHERE SH.COMMISSION_PCT IS NOT NULL 
);
--WHERE  EXISTS(SELECT DEPARTMENT_NAME FROM S_HRDEPARTMENTS sh2);

SELECT DEPARTMENT, MAX(SALARY) AS MAX_SAL FROM S_HREMPLOYEES sh GROUP BY DEPARTMENT HAVING MAX(SALARY)>20000;

SELECT * FROM S_HREMPLOYEES sh ORDER BY DEPARTMENT, SALARY ;

SEELCT EMPLOYEE_ID FROM S_HREMPLOYEES sh LIKE '[A-H]%';

CREATE TABLE dlithe.dbo.SHK_EMP(
EMP_ID INT,
EMP_NAME VARCHAR(20),
EMP_JOB VARCHAR(10)
)

SELECT * FROM SHK_EMP;

TRUNCATE TABLE SHK_EMP;

DROP TABLE SHK_EMP;

CREATE TABLE dlithe.dbo.SHK_EMP(
EMP_ID INT,
EMP_NAME VARCHAR(20),
EMP_JOB VARCHAR(10)
)

SELECT * FROM SHK_EMP;

INSERT INTO SHK_EMP VALUES(1,'SHRAVAN','DB');
INSERT INTO SHK_EMP VALUES(2,'KUMAR','TESTING');
INSERT INTO SHK_EMP VALUES(3,'SHRAVAN','JAVA');

DELETE FROM SHK_EMP WHERE EMP_NAME='SHRAVAN';

INSERT INTO SHK_EMP VALUES(1,'SHRAVAN','DB');
INSERT INTO SHK_EMP VALUES(2,'KUMAR','TESTING');
INSERT INTO SHK_EMP VALUES(3,'SHRAVAN','JAVA');

UPDATE SHK_EMP
SET EMP_NAME='PRAVEEN', EMP_JOB='DOTNET'
--WHERE EMP_ID=3;

INSERT INTO SHK_EMP VALUES(1,'SHRAVAN','DB');
INSERT INTO SHK_EMP VALUES(2,'KUMAR','TESTING');
INSERT INTO SHK_EMP VALUES(3,'SHRAVAN','JAVA');

--ALTER TABLE SHK_EMP RENAME TO SHK_JOB; 

--ALTER TABLE SHK_EMP RENAME COLUMN EMP_ID TO JOB_ID;

EXEC sp_RENAME 'dbo.SHK_EMP.EMP_NAME', 'NAME', 'COLUMN';

EXEC sp_RENAME 'dbo.student.NAME2', 'NAME_123', 'COLUMN';

EXEC SP_RENAME 'DBO.SHK_EMP','SHK_JOB';

SELECT * FROM SHK_JOB;

ALTER TABLE SHK_JOB 
ADD EMP_SAL INT CHECK(EMP_SAL>10000);

ALTER TABLE SHK_JOB 
DROP COLUMN EMP_SAL;

INSERT INTO SHK_JOB VALUES(1,'SS','IT',9000);

ALTER TABLE SHK_JOB DROP CONSTRAINT CHK_SHK_JOB_EMP_SAL CHECK([EMP_SAL]>10000); 

CREATE TABLE dlithe.dbo.SHK_STUDENT(
S_ID INT PRIMARY KEY,
S_NAME VARCHAR(20) NOT NULL,
DEPT_ID INT,
EMAIL VARCHAR(20) DEFAULT 'ABC@GMAIL.COM'
);

CREATE TABLE dlithe.dbo.SHK_DEPART(
DEPT_ID INT FOREIGN KEY(DEPT_ID) REFERENCES SHK_STUDENT(S_ID),
DEPT_NAME VARCHAR(20),
DEPT_MANAGER VARCHAR(20)
);

INSERT INTO SHK_STUDENT VALUES(101,'SHRAVAN',1);
INSERT INTO SHK_STUDENT VALUES(102,'KUMAR',2,NULL);
INSERT INTO SHK_STUDENT VALUES(103,'SACHIN',2,NULL);
INSERT INTO SHK_STUDENT VALUES(104,'ABHI',2,NULL);
INSERT INTO SHK_STUDENT VALUES(105,'SOORI',3,NULL);
INSERT INTO SHK_STUDENT VALUES(106,'SUDEEP',3,NULL);

UPDATE SHK_STUDENT 
SET EMAIL='ABC@GMAIL.COM';

SELECT * FROM SHK_STUDENT;

INSERT INTO SHK_DEPART VALUES(101,'ECE','SS');
INSERT INTO SHK_DEPART VALUES(102,'CS','SK');
--INSERT INTO SHK_DEPART VALUES(3,'IS','SO');

SELECT * FROM SHK_DEPART;

SELECT * FROM SHK_STUDENT WHERE S_ID>101;

ALTER TABLE SHK_STUDENT 
ADD PACKG INT ;

UPDATE SHK_STUDENT
SET PACKG=10000 WHERE S_ID=101;
UPDATE SHK_STUDENT
SET PACKG=20000 WHERE S_ID>101 AND S_ID<105;
UPDATE SHK_STUDENT
SET PACKG=30000 WHERE S_ID>104;

SELECT  DEPT_ID,SUM(PACKG) FROM SHK_STUDENT 
GROUP BY DEPT_ID
HAVING SUM(PACKG)>10000
ORDER BY DEPT_ID DESC;

SELECT SUBSTRING(EMAIL,1,5),CONCAT(S_NAME,EMAIL)AS SS, LEN(S_NAME) AS LEN FROM SHK_STUDENT;

SELECT *FROM SHK_STUDENT;
SELECT * FROM SHK_DEPART;

INSERT INTO SHK_STUDENT VALUES(107,'KUMAR',2,'ABC@GMAIL.COM',10000);

SELECT * FROM SHK_STUDENT SH1
INNER JOIN SHK_DEPART SH2
ON SH1.S_ID  =SH2.DEPT_ID;

SELECT * FROM SHK_STUDENT SH1
LEFT JOIN SHK_DEPART SH2
ON SH1.S_ID=SH2.DEPT_ID;

SELECT * FROM SHK_STUDENT SH1
RIGHT JOIN SHK_DEPART SH2
ON SH1.S_ID=SH2.DEPT_ID;

SELECT * FROM SHK_STUDENT SH1
FULL OUTER JOIN SHK_DEPART SH2
ON SH1.S_ID=SH2.DEPT_ID;

SELECT * FROM (
SELECT DENSE_RANK () OVER (PARTITION BY DEPARTMENT_ID ORDER BY HIRE_DATE  ASC) AS DRNK,SALARY,DEPARTMENT_ID,HIRE_DATE
FROM DBO.S_HREMPLOYEES sh 
--WHERE DEPARTMENT_ID=90
)X
WHERE DRNK=3

SELECT * FROM (
SELECT RANK() OVER (PARTITION BY DEPT_ID ORDER BY S_ID ASC)AS DRNK, S_ID,S_NAME,DEPT_ID FROM SHK_STUDENT
)X

SELECT 50 | 0001
FROM SHK_DEPART sd ;

SELECT S_NAME  NULL
FROM SHK_STUDENT ss 
WHERE S_ID  = 101 ;

SELECT  CASE WHEN DEPARTMENT_ID=30 THEN 'IT' 
WHEN DEPARTMENT_ID=50 THEN 'HR'
WHEN (DEPARTMENT_ID=30 )and (SALARY >10000) and (FIRST_NAME != 'David') THEN 'finance'
ELSE 'OTHER'
END AS DNAME
FROM S_HREMPLOYEES;

select case when DEPARTMENT_ID = 60 then 'IT'
when DEPARTMENT_ID = 90 then 'HR'
when DEPARTMENT_ID = 50 and SALARY >10000 and FIRST_NAME  <>'David' then 'finance'
else 'Others'
end as dname, FIRST_NAME, DEPARTMENT_ID 
from dlithe. dbo.S_HREMPLOYEES

SELECT * FROM S_HREMPLOYEES sh ;

SELECT * FROM SKT_NEWTABLE sn ;

SELECT * FROM SHK_STUDENT ss ;

CREATE TABLE SHK_DEMO(
S_ID INT ,
S_NAME VARCHAR(20),
DEPT_ID INT,
EMAIL VARCHAR(20)
)

SELECT * FROM SHK_DEMO;

CREATE TABLE SHK_DEMO1(
id INT,
name VARCHAR(50),
age INT,
salary INT,
department VARCHAR(20),
place VARCHAR(20)
)

SELECT * FROM SHK_DEMO1 ;

SELECT * FROM SHK_JOB sj ;

--CTE

WITH DE AS
(
SELECT * ,ROW_NUMBER() OVER(PARTITION BY NAME ORDER BY EMP_ID) AS DD
FROM SHK_JOB sj 
)
 DELETE FROM DE 
 WHERE DD>1;

--COPYING 

SELECT * INTO SHK_JOB_NEW
FROM SHK_JOB sj 
WHERE 1=2;

SELECT * FROM SHK_JOB_NEW ;

INSERT INTO SHK_JOB_NEW 
SELECT DISTINCT * FROM SHK_JOB;

SELECT * FROM SHK_JOB_NEW;

CREATE TABLE SHK_DEMO2(
id INT,
name VARCHAR(40),
age INT,
salary INT,
department VARCHAR(20),
place VARCHAR(20)
);

SELECT * FROM SHK_DEMO2 ;

CREATE TABLE SHK_DEMO3(
id INT,
name VARCHAR(25),
age INT,
address VARCHAR(30),
slary INT,
role VARCHAR(20)
);

SELECT * FROM SHK_DEMO3;

SELECT * INTO SHK_EMPLOYEES_NEW 
FROM S_HREMPLOYEES sh 
WHERE 1=2;

SELECT * FROM SHK_EMPLOYEES_NEW ;

CREATE TABLE SHK_DEMO4(
Years INT,
State VARCHAR(20),
HAI	VARCHAR(100),
Operative_Procedure	VARCHAR(30),
Facility_ID	INT,
Facility_Name VARCHAR(50),
Hospital_Category_RiskAdjustment VARCHAR(100),
Hospital_Type VARCHAR(100),
County VARCHAR(50),
Procedure_Count	INT,
Infection_Count INT,
Predicted_Infection_Count FLOAT,
SIR	FLOAT,
FLOATSIR_CI_95_Lower_Limit FLOAT ,
FLOATSIR_CI_95_Upper_Limit	FLOAT,
Comparison VARCHAR(20),	
SIR_2015 FLOAT,
OnTrack_Toward_2020_Goal VARCHAR(50),
Notes VARCHAR(50)
);

ALTER TABLE SHK_DEMO7
ALTER COLUMN Operative_Procedure VARCHAR(100);

ALTER TABLE SHK_DEMO4
ALTER COLUMN Comparison VARCHAR(100);

ALTER TABLE SHK_DEMO4
ALTER COLUMN Facility_Name VARCHAR(200);

SELECT * FROM SHK_DEMO6;

INSERT INTO SHK_DEMO6 VALUES(1,'ABHI',22,'UDUPI',10000,IT);
INSERT INTO SHK_DEMO6 VALUES(2,'ABHI',22,'UDUPI',10000,IT);
INSERT INTO SHK_DEMO6 VALUES(3,'ABHI',22,'UDUPI',10000,IT);

CREATE TABLE SHK_NEW(
id INT,
name VARCHAR(25),
age INT,
address VARCHAR(30),
slary INT,
role VARCHAR(20)
);
INSERT INTO SHK_NEW VALUES(1,'ABHI',22,'UDUPI',10000,'IT,');
INSERT INTO SHK_NEW VALUES(2,'SHEK',23,'UDUPI',20000,'IT,');
INSERT INTO SHK_NEW VALUES(3,'BHAT',24,'UDUPI',30000,'DB,');
UPDATE SHK_NEW SET name='SACHIN' WHERE id=2;
TRUNCATE TABLE SHK_DEMO4 ;
DROP TABLE SHK_DEMO6 ;

SELECT * FROM SHK_NEW;

CREATE TABLE COLUMNSS(
ID INT,
FIRST_NAME VARCHAR(20),
LAST_NAME VARCHAR(20),
LOCATION VARCHAR(30),
EMP_ID INT,
FULL_NAME VARCHAR(40),
F_NAME VARCHAR(20)
);

SELECT * FROM COLUMNSS ;

CREATE TABLE SHK_MERGE(
Row_ID INT,
Order_ID VARCHAR(100),
Order_Date VARCHAR(100),
Ship_Date VARCHAR(100),
Ship_Mode VARCHAR(100),
Customer_ID VARCHAR(100),
Customer_Name VARCHAR(100),
Segment	VARCHAR(100),
Country VARCHAR(100),
City VARCHAR(100),
State	VARCHAR(100),
Postal_Code INT,
Region	VARCHAR(100),
Product_ID VARCHAR(100),
Category VARCHAR(100),
Sub_Category VARCHAR(100),
Product_Name VARCHAR(100),
Sales FLOAT,
Quantity INT,
Discount FLOAT,
Profit FLOAT
);

ALTER TABLE SHK_MERGE 
ALTER COLUMN Product_Name VARCHAR(200);

SELECT * FROM SHK_MERGE ;

CREATE TABLE SHK_MERGE1(
id INT,
name VARCHAR(25),
age INT,
address VARCHAR(30),
slary INT,
roleS VARCHAR(20)
);

INSERT INTO SHK_MERGE1 VALUES(1,'ABHI',22,'UDUPI',10000,'IT');
INSERT INTO SHK_MERGE1 VALUES(1,'ABHI',22,'UDUPI',10000,'IT');
INSERT INTO SHK_MERGE1 VALUES(2,'BHAT',23,'UDUPI',20000,'DB');
INSERT INTO SHK_MERGE1 VALUES(2,'BHAT',23,'UDUPI',20000,'DB');
INSERT INTO SHK_MERGE1 VALUES(3,'SACHIN',24,'UDUPI',30000,'TEST');
INSERT INTO SHK_MERGE1 VALUES(3,'SACHIN',24,'UDUPI',30000,'TEST');


SELECT * FROM SHK_MERGE1;


CREATE TABLE SHK_MERGE2(
id INT,
name VARCHAR(25),
age INT,
address VARCHAR(30),
slary INT,
roleS VARCHAR(20)
);

INSERT INTO SHK_MERGE2 VALUES(1,'ABHI',22,'UDUPI',10000,'IT');
INSERT INTO SHK_MERGE2 VALUES(1,'ABHI',22,'UDUPI',10000,'IT');
INSERT INTO SHK_MERGE2 VALUES(2,'BHAT',23,'UDUPI',20000,'DB');
INSERT INTO SHK_MERGE2 VALUES(2,'BHAT',23,'UDUPI',20000,'DB');
INSERT INTO SHK_MERGE2 VALUES(3,'SACHIN',24,'UDUPI',30000,'TEST');
INSERT INTO SHK_MERGE2 VALUES(3,'SACHIN',24,'UDUPI',30000,'TEST');


SELECT * FROM SHK_MERGE2;

CREATE TABLE SHK_MERGE3(
id INT,
name VARCHAR(25),
age INT,
address VARCHAR(30),
slary INT,
roleS VARCHAR(20)
);

SELECT * FROM SHK_MERGE3;

CREATE TABLE SHK_UNION1(
id INT,
name VARCHAR(100),
age INT,
salary INT,
department VARCHAR(100),
place VARCHAR(100)
);

SELECT * FROM SHK_UNION1;

CREATE TABLE SHK_UNION2(
id INT,
name VARCHAR(100),
age INT,
salary INT,
department VARCHAR(100),
place VARCHAR(100)
);

SELECT * FROM SHK_UNION2;

TRUNCATE TABLE SHK_STUDENTS;

CREATE TABLE SHK_UNION3(
id INT,
name VARCHAR(100),
age INT,
salary INT,
department VARCHAR(100),
place VARCHAR(100)
);

INSERT INTO SHK_UNION3 VALUES(7,'darshan',23,10000,'manager','delhi');
INSERT INTO SHK_UNION3 VALUES(8,'shon',23,20000,'db','kolkata');
INSERT INTO SHK_UNION3 VALUES(9,'sudeep',23,50000,'test','lucknow');

CREATE TABLE SHK_UNION4(
id INT,
name VARCHAR(100),
age INT,
salary INT,
department VARCHAR(100),
place VARCHAR(100)
);

INSERT INTO SHK_UNION4 VALUES(13,'hegde',23,10000,'test','delhi');
INSERT INTO SHK_UNION4 VALUES(14,'kaushik',24,20000,'java','kolkata');
INSERT INTO SHK_UNION4 VALUES(15,'verendra',25,50000,'db','lucknow');

SELECT * FROM SHK_UNION1;
SELECT * FROM SHK_UNION3;
SELECT * FROM SHK_UNION4;

CREATE TABLE SHK_STUDENTS(
id INT,
name VARCHAR(100),
dept VARCHAR(100),
marks INT
);

INSERT INTO SHK_STUDENTS VALUES(1,'SHRAVAN','ECE',90);
INSERT INTO SHK_STUDENTS VALUES(2,'KUMAR','CSE',80);
INSERT INTO SHK_STUDENTS VALUES(3,'SACHIN','ISE',70);
INSERT INTO SHK_STUDENTS VALUES(4,'ABHISHEK','ECE',55);
INSERT INTO SHK_STUDENTS VALUES(5,'SANATH','CSE',40);
INSERT INTO SHK_STUDENTS VALUES(6,'SOORI','ISE',50);
INSERT INTO SHK_STUDENTS VALUES(7,'DHANUSH','ECE',30);
INSERT INTO SHK_STUDENTS VALUES(8,'SHON','CSE',35);
INSERT INTO SHK_STUDENTS VALUES(9,'SHREYAS','ISE',25);

SELECT * FROM SHK_STUDENTS;

CREATE TABLE SHK_STUDENTS_FD(
id INT,
name VARCHAR(100),
dept VARCHAR(100),
marks INT
);

CREATE TABLE SHK_STUDENTS_PASS(
id INT,
name VARCHAR(100),
dept VARCHAR(100),
marks INT
);

CREATE TABLE SHK_STUDENTS_FAIL(
id INT,
name VARCHAR(100),
dept VARCHAR(100),
marks INT
);

SELECT * FROM SHK_STUDENTS_FD;
SELECT * FROM SHK_STUDENTS_PASS;
SELECT * FROM SHK_STUDENTS_FAIL;

CREATE TABLE SHK_Sales_YR_2022(
s_year INT,
prodcut VARCHAR(100),
quantity INT,
amount INT
);

CREATE TABLE SHK_Sales_YR_2021(
s_year INT,
prodcut VARCHAR(100),
quantity INT,
amount INT
);

SELECT * FROM SHK_Sales_YR_2022;
SELECT * FROM SHK_Sales_YR_2021;
SELECT * FROM SHK_Sales_YR_2020;

CREATE TABLE SHK_Sales_YR_2020(
s_year INT,
prodcut VARCHAR(100),
quantity INT,
amount INT
);

CREATE TABLE SHK_ExamResult
(StudentName VARCHAR(70), 
 Subject     VARCHAR(20), 
 Marks       INT
);
INSERT INTO SHK_ExamResult VALUES('DHANUSH',  'Maths',  65);
INSERT INTO SHK_ExamResult VALUES('DHANUSH',  'Science',  80);
INSERT INTO SHK_ExamResult VALUES('DHANUSH',  'english',  70);
INSERT INTO SHK_ExamResult VALUES('SHREYAS',  'Maths', 50);
INSERT INTO SHK_ExamResult VALUES('SHREYAS',  'Science',  70);
INSERT INTO SHK_ExamResult VALUES('SHREYAS',  'english',  90);
INSERT INTO SHK_ExamResult VALUES('SHON',  'Maths',  55);
INSERT INTO SHK_ExamResult VALUES('SHON',  'Science',  60);
INSERT INTO SHK_ExamResult VALUES('SHON',  'english',  89);

SELECT * FROM SHK_ExamResult ;

SELECT *, ROW_NUMBER() OVER(ORDER BY Marks) AS RowNumber FROM SHK_ExamResult;

SELECT *,RANK() OVER(ORDER BY Marks DESC) Ranks FROM SHK_ExamResult;

SELECT * , DENSE_RANK() OVER(ORDER BY Marks ASC) AS Ranks FROM SHK_ExamResult;
--WHERE Subject='Maths' AND Ranks=4;
SELECT * FROM ( SELECT StudentName,Subject, DENSE_RANK() OVER(ORDER BY Marks ASC) AS Ranks FROM SHK_ExamResult
)X
WHERE Subject='Maths' AND Ranks=4;

CREATE TABLE SHK_SKS(
ID INT,
NAME VARCHAR(20),
PLACE VARCHAR(30),
);

INSERT INTO SHK_SKS VALUES(1,'PRAVEEN','MANGALORE');
INSERT INTO SHK_SKS VALUES(1,'PRAVEEN','MANGALORE');
INSERT INTO SHK_SKS VALUES(1,'PRAVEEN','MANGALORE');
INSERT INTO SHK_SKS VALUES(2,'DHANUSH','UDUPI');
INSERT INTO SHK_SKS VALUES(2,'DHANUSH','UDUPI');
INSERT INTO SHK_SKS VALUES(2,'DHANUSH','UDUPI');

SELECT * FROM SHK_SKS;

SELECT * FROM S_HREMPLOYEES sh ;

SELECT CASE WHEN DEPARTMENT_ID=90 THEN 'HR'
ELSE 'OTHERS'
END 
FROM S_HREMPLOYEES sh ;

SELECT * FROM SHK_STUDENT2;

SELECT *, SUBSTRING(EMAIL,CHARINDEX('@',EMAIL)+1,LEN(EMAIL)) AS DOMAINS FROM SHK_STUDENT;

SELECT REPLACE(EMAIL,'@','-') FROM SHK_STUDENT;

SELECT *, REPLACE(REPLACE(REPLACE(REPLACE(EMAIL,'@','-'),'.','-'),'&','-'),'$','-') FROM SHK_STUDENT;

CREATE TABLE dlithe.dbo.SHK_STUDENT2(
S_ID INT ,
S_NAME VARCHAR(20) ,
DEPT_ID INT,
EMAIL VARCHAR(20) 
);

CREATE TABLE dlithe.dbo.SHK_STUDENT3(
S_ID INT ,
S_NAME VARCHAR(20) ,
DEPT_ID INT,
EMAIL VARCHAR(20),
DERIVED_COLUMN VARCHAR(20)
);
SUBSTRING(EMAIL,LEN(EMAIL) - FINDSTRING(REVERSE(EMAIL),"@",1) + 3,FINDSTRING(REVERSE(EMAIL),"@",1) - 1);

SELECT * FROM SHK_STUDENT3;

TRUNCATE TABLE SHK_STUDENT3;


SELECT * FROM SHK_UNION4 su ;

CREATE TABLE SHK_LOOKUP(
id INT,
name VARCHAR(100),
age INT,
salary INT,
department VARCHAR(100),
place VARCHAR(100)
);
 

CREATE TABLE SHK_LOOKUP2(
id INT,
name VARCHAR(100),
age INT,
salary INT,
department VARCHAR(100),
place VARCHAR(100)
);


UPDATE SHK_LOOKUP2
SET name=?,
age=?,
salary=?,
department=?,
place=?
WHERE ID=?;

CREATE TABLE SHK_CONTAINER(
id INT,
name VARCHAR(100),
age INT,
salary INT,
department VARCHAR(100),
place VARCHAR(100)
);

CREATE TABLE SHK_SEQ_CONTAINER(
id INT,
name VARCHAR(100),
age INT,
salary INT,
department VARCHAR(100),
place VARCHAR(100)
);

SELECT * FROM SHK_SEQ_CONTAINER;

CREATE TABLE SHK_SEQ_CONTAINER2(
id INT,
name VARCHAR(100),
age INT,
salary INT,
department VARCHAR(100),
place VARCHAR(100)
);


SELECT * FROM SHK_SEQ_CONTAINER2;

TRUNCATE TABLE SHK_SEQ_CONTAINER;

CREATE TABLE SHK_EMP(
EMP_ID INT,
NAME VARCHAR(100),
ZIPCODE VARCHAR(100)
);
SELECT * FROM SHK_EMP;

CREATE TABLE SHK_ADDRESS(
ZIPCODE VARCHAR(100),
COUNTRY VARCHAR(100),
CITY VARCHAR(100)
);

ALTER  TABLE SHK_EMP
ALTER COLUMN EMP_ID INT NOT NULL;

ALTER TABLE SHK_EMP
ADD CONSTRAINT EMP_ID_PK PRIMARY KEY(EMP_ID);

ALTER TABLE SHK_EMP
ADD EMP_ID2 VARCHAR(100);

ALTER TABLE SHK_ADDRESS 
ADD ZIPCODE1 INT;

ALTER TABLE SHK_ADDRESS
ADD CONSTRAINT ZIPCODE1 FOREIGN KEY(ZIPCODE1)
REFERENCES SHK_EMP(ZIPCODE);

INSERT INTO SHK_EMP VALUES(1,'SHON','100');
INSERT INTO SHK_EMP VALUES(2,'ROY','100');
INSERT INTO SHK_EMP VALUES(3,'DHANUSH','101');
INSERT INTO SHK_EMP VALUES(4,'PRUTVI','101');
INSERT INTO SHK_EMP VALUES(5,'RAMESH','102');
INSERT INTO SHK_EMP VALUES(6,'KUMAR','102');

INSERT INTO SHK_ADDRESS VALUES('100','INDIA','BANGALORE');
INSERT INTO SHK_ADDRESS VALUES('101','AUSTRALIA','MELBOURNE');
INSERT INTO SHK_ADDRESS VALUES('102','USA','NEW YORK');
INSERT INTO SHK_ADDRESS VALUES('103','RUSSIA','MOSCOW');

SELECT * FROM SHK_EMP AS E
LEFT JOIN SHK_ADDRESS AS A 
ON E.ZIPCODE=A.ZIPCODE;

SELECT * FROM SHK_EMP AS E
RIGHT JOIN SHK_ADDRESS AS A 
ON E.ZIPCODE=A.ZIPCODE;

SELECT * FROM SHK_EMP AS E
INNER JOIN SHK_ADDRESS AS A 
ON E.ZIPCODE=A.ZIPCODE;

SELECT * FROM SHK_EMP AS E
FULL OUTER JOIN SHK_ADDRESS AS A 
ON E.ZIPCODE=A.ZIPCODE;

--CROSS JOIN
SELECT * FROM SHK_EMP,SHK_ADDRESS;

CREATE TABLE SHK_DEPT12(
DEPT_ID INT PRIMARY KEY,
DEPT_NAME VARCHAR(20) NOT NULL,
DEPT_LOCATION VARCHAR(50)
);


CREATE TABLE SHK_EMPLOYEE12(
EMP_ID INT PRIMARY KEY,
EMP_NAME VARCHAR(20) UNIQUE,
EMP_AGE INT,
EMP_ADDRESS VARCHAR(50) DEFAULT 'NOT PROVIDED',
DEPT_NO INT FOREIGN KEY(DEPT_NO) REFERENCES SHK_DEPT12(DEPT_ID)
);

INSERT INTO SHK_DEPT12 VALUES(1,'JAVA','BANGALORE');
INSERT INTO SHK_DEPT12 VALUES(2,'DOTNET','BANGALORE');
INSERT INTO SHK_DEPT12 VALUES(3,'DATABASE','BANGALORE');
INSERT INTO SHK_DEPT12 VALUES(4,'TESTING','BANGALORE');

SELECT * FROM SHK_DEPT12; 

INSERT INTO SHK_EMPLOYEE12 VALUES(1,'SACHIN',22,'BANGALORE',1);
INSERT INTO SHK_EMPLOYEE12 VALUES(2,'ABHISHEK',22,'MUMBAI',1);
INSERT INTO SHK_EMPLOYEE12 VALUES(3,'ARUN',22,'UDUPI',2);
INSERT INTO SHK_EMPLOYEE12(EMP_ID,EMP_NAME,EMP_AGE,DEPT_NO) VALUES(4,'ARJUN',22,2);
INSERT INTO SHK_EMPLOYEE12(EMP_ID,EMP_NAME,EMP_AGE,DEPT_NO) VALUES(5,'SHON',22,3);

SELECT * FROM SHK_EMPLOYEE12;

CREATE VIEW SHK_VWEMP
AS
SELECT * FROM SHK_CONTAINER sc ;

SELECT * FROM SHK_VWEMP;

ALTER VIEW SHK_VWEMP 
AS
SELECT * FROM SHK_EMPLOYEE;

SELECT * FROM SHK_VWEMP;

SELECT * FROM SHK_EMPLOYEE;
SELECT * FROM SHK_DEPARTMENT sd ;

INSERT INTO SHK_EMPLOYEE VALUES(7,'KUMAR',22,'UDUPI',6);

UPDATE SHK_VWEMP 
SET EMP_ADDRESS='MANGALORE' WHERE EMP_ID=1;

SELECT * FROM SHK_VWEMP;

INSERT INTO SHK_DEPARTMENT VALUES(5,'PYTHON','CHENNAI');

ALTER VIEW SHK_VWEMP 
AS
SELECT * FROM 
SHK_EMPLOYEE AS S
INNER JOIN SHK_DEPARTMENT AS D
ON S.DEPT_NO = D.DEPT_ID ;

SELECT * FROM SHK_VWEMP;

ALTER VIEW SHK_VWEMP 
AS
SELECT * FROM 
SHK_EMPLOYEE AS S
FULL OUTER JOIN SHK_DEPARTMENT AS D
ON S.DEPT_NO = D.DEPT_ID ;

----3NF-----

CREATE TABLE dlithe.dbo.SHK_DEPARTMENT22(
DEPT_ID INT,
DEPT_NAME VARCHAR(20),
DEPT_LOCATION VARCHAR(50)
);

CREATE TABLE dlithe.dbo.SHK_EMPLOYEE22(
EMP_ID INT ,
EMP_NAME VARCHAR(20),
EMP_AGE INT,
EMP_ADDRESS VARCHAR(50),
DEPT_NO INT FOREIGN KEY(DEPT_NO) REFERENCES SHK_DEPARTMENT(DEPT_ID)
);

INSERT INTO SHK_DEPARTMENT22 VALUES(1,'JAVA','BANGALORE');
INSERT INTO SHK_DEPARTMENT22 VALUES(2,'DOTNET','BANGALORE');
INSERT INTO SHK_DEPARTMENT22 VALUES(3,'DATABASE','BANGALORE');
INSERT INTO SHK_DEPARTMENT22 VALUES(4,'TESTING','BANGALORE');

SELECT * FROM SHK_DEPARTMENT;

INSERT INTO SHK_EMPLOYEE22 VALUES(1,'SACHIN',22,'BANGALORE',1);
INSERT INTO SHK_EMPLOYEE22 VALUES(2,'ABHISHEK',22,'BANGALORE',1);
INSERT INTO SHK_EMPLOYEE22 VALUES(3,'ARUN',22,'BANGALORE',2);
INSERT INTO SHK_EMPLOYEE22 VALUES(4,'ARJUN',22,'BANGALORE',2);
INSERT INTO SHK_EMPLOYEE22 VALUES(5,'SHON',22,'BANGALORE',3);

SELECT * FROM SHK_EMPLOYEE ;

-----2NF----
CREATE TABLE SHK_EMP33(
NAME VARCHAR(20),
ID INT,
DEPT_NAME VARCHAR(10)
);

CREATE TABLE SHK_DEPT33(
DEPT_NAME VARCHAR(20),
DEPT_ID INT,
);
-----1NF------
CREATE TABLE SHK_EMP22(
ID INT,
NAME VARCHAR(20),
DEPT VARCHAR(20),
MOB INT
);
SELECT * FROM SHK_EMP22;
INSERT INTO SHK_EMP22 VALUES( 1,'ARUN,KUMAR','DB',111111111);
INSERT INTO SHK_EMP22 VALUES(1,'ARUN','DB',111111111);
INSERT INTO SHK_EMP22 VALUES(1,'KUMAR','DB',111111111);

CREATE TABLE SHK_SCD(
id INT,
name VARCHAR(100),
age INT,
salary INT,
department VARCHAR(100),
place VARCHAR(100)
);

CREATE TABLE SHK_SCD1(
id INT,
name VARCHAR(100),
age INT,
salary INT,
department VARCHAR(100),
place VARCHAR(100)
);

INSERT INTO SHK_SCD VALUES(1,'darshan',23,10000,'manager','delhi');
INSERT INTO SHK_SCD VALUES(2,'shon',23,20000,'db','kolkata');
INSERT INTO SHK_SCD VALUES(3,'sudeep',23,50000,'test','lucknow');

SELECT * FROM SHK_SCD;

UPDATE SHK_SCD 
SET place='mumbai' WHERE name='darshan';

CREATE TABLE SHK_SCD2(
id INT,
name VARCHAR(100),
age INT,
salary INT,
department VARCHAR(100),
place VARCHAR(100)
);

CREATE TABLE SHK_SCD3(
id INT,
name VARCHAR(100),
age INT,
salary INT,
department VARCHAR(100),
place VARCHAR(100)
);

INSERT INTO SHK_SCD2 (2,'shon',23,20000,'db','kolkata');
INSERT INTO SHK_SCD2 VALUES(3,'sudeep',23,50000,'test','lucknow');

SELECT * FROM SHK_SCD2;

--UPDATE SHK_SCD2 
--SET name='shravan' WHERE id=1

UPDATE SHK_SCD2 
SET department='java' WHERE id=1;

SELECT * FROM SHK_SCD3;

UPDATE SHK_SCD2 
SET department='python', place='mangalore' WHERE id=1;

ALTER TABLE SHK_SCD3 
ADD START_DATE DATE , END_DATE DATE;

UPDATE SHK_SCD2
SET department='Cloud' WHERE id =1;

CREATE TABLE SHK_SCD4(
id INT,
name VARCHAR(100),
age INT,
salary INT,
department VARCHAR(100),
place VARCHAR(100),
);

CREATE TABLE SHK_SCD5(
id INT,
name VARCHAR(100),
age INT,
salary INT,
department VARCHAR(100),
place VARCHAR(100),
);

INSERT INTO SCD4 VALUES(1,'DHANUSH',22,100000,'IT','BANGALORE');

SELECT * FROM SHK_SCD4;

SELECT DISTINCT JOB_ID FROM S_HREMPLOYEES;

SELECT * FROM SHK_EMPLOYEE123 se ;

SELECT * FROM S_HREMPLOYEES;

SELECT * FROM SHK_EMP123 se ;